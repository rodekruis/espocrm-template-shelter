id,name,description,targetType,data,isActive,eventStartIdList,eventStartAllIdList,createdAt,modifiedAt,categoryId,categoryName,assignedUserId,assignedUserName,createdById,createdByName,modifiedById,modifiedByName
672a1638ef342ec72,"AffectedHousehold - Create message based on Message template","When a message template is added to the field ""Send message"" in the Affected Household entity, a Message record will be created with the body of the message template (in the preferred language), the phone number of the head of household and the status ""to be send"", so that it will be put in the queue to send the message out (in a different flow)",AffectedHousehold,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":180},""triggerType"":""afterRecordUpdated"",""isInterrupting"":false,""id"":""nfa1cuvnz5"",""text"":""Message template is assigned to household"",""description"":null,""conditionsAll"":[{""comparison"":""notEmpty"",""cid"":0,""fieldToCompare"":""messageTemplate"",""type"":""all""},{""comparison"":""changed"",""cid"":1,""fieldToCompare"":""messageTemplate"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null},{""type"":""taskScript"",""center"":{""x"":240,""y"":180},""id"":""ehmi25siei"",""text"":""Create message"",""description"":null,""formula"":""\/\/---- get language of message based on preferred language -----\n\n\/\/ get preferred language\n$lan = preferredLanguage;\n\n\/\/ set default language\nifThen($lan == None, $lan = 'en');\nifThen($lan == 'other', $lan = 'en');\n\n\/\/ set body of message based on lagnauge\n\/\/ --- UPDATE THIS PART BASED ON POSSIBLE LANGUAGES IN SYSTEM ---\nifThenElse($lan == 'en', $body = messageTemplate.bodyEN);\nifThenElse($lan == 'fr', $body = messageTemplate.bodyFR);\nifThenElse($lan == 'ar', $body = messageTemplate.bodyAR);\nifThenElse($lan == 'zh', $body = messageTemplate.bodyZH);\nifThenElse($lan == 'ru', $body = messageTemplate.bodyRU);\nifThenElse($lan == 'es', $body = messageTemplate.bodyES);\n\n\/\/ create message record, with information from message template\n$messageId = record\\create('Message', 'sendBody', $body, 'to', phoneNumber, 'status', 'tobe', 'language', $lan);\n\n \/\/ add name to message record\n$name = string\\concatenate(messageTemplate.name, ' - ', hhID, ' - ', datetime\\today());\nrecord\\update('Message', $messageId, 'name', $name);\n\n\/\/ Relate created message record to affected household, PA and to message template\nrecord\\relate('Message', $messageId, 'affectedHousehold', id);\nrecord\\relate('Message', $messageId, 'cPersonAffected', cPersonAffectedId);\nrecord\\relate('Message', $messageId, 'messageTemplate', messageTemplateId);"",""isolateVariables"":false},{""startId"":""nfa1cuvnz5"",""endId"":""ehmi25siei"",""startDirection"":""r"",""id"":""0h25re00nu"",""type"":""flow""},{""type"":""eventEnd"",""center"":{""x"":500,""y"":180},""id"":""mwe5oor7bl""},{""type"":""taskScript"",""center"":{""x"":380,""y"":180},""id"":""nyw62vggwv"",""text"":""Remove Message Template from Affected Household"",""description"":null,""formula"":""messageTemplateId = null;""},{""startId"":""ehmi25siei"",""endId"":""nyw62vggwv"",""startDirection"":""r"",""id"":""vfxfbdfpba"",""type"":""flow""},{""startId"":""nyw62vggwv"",""endId"":""mwe5oor7bl"",""startDirection"":""r"",""id"":""po2kosmw12"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""nfa1cuvnz5""]","2024-11-05 12:57:28","2025-09-25 13:26:25",,,,,671fa426716cd8d35,,68d530a06516d55bf,Admin
672a09e61bfcc8f1e,"AffectedHousehold - Create or Link PA from affected households","When a new household is created, automatically create a linked contact and fill in contact information

When a new affected household is registered, search in PA entity if there is an existing PA record with the same ID number.

If PA record exisits, link affected household to PA record. If PA record not exists, create a new PA and fill in the information from the affected household record.",AffectedHousehold,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":80,""y"":200},""triggerType"":""afterRecordCreated"",""isInterrupting"":false,""id"":""hnd1x4wtrd"",""text"":""When affected household is created"",""description"":null,""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":null},{""type"":""eventEnd"",""center"":{""x"":660,""y"":200},""id"":""4cio96rbso""},{""type"":""taskScript"",""center"":{""x"":180,""y"":200},""id"":""7egut5oc75"",""text"":""Search for existing PA with equal ID number"",""description"":null,""formula"":""$PAId = record\\findOne('CPersonAffected', 'createdAt', 'desc', 'idNumber', idNumber);""},{""type"":""gatewayExclusive"",""center"":{""x"":280,""y"":200},""id"":""g26501dqtx"",""text"":""Check if PA already exists"",""description"":null,""defaultFlowId"":null,""flowList"":[{""id"":""1zu8oy54j5"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":""$PAId == null;""},{""id"":""1lel1th6cp"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":""$PAId != null;""}]},{""type"":""taskScript"",""center"":{""x"":380,""y"":140},""id"":""43vu6dm3ec"",""text"":""Create PA with all information"",""description"":null,""formula"":""$PAId = record\\create(\n    'CPersonAffected',\n    'firstName', firstName, \n    'lastName', lastName, \n    'nationality', nationality,\n    'gender', gender, \n    'dateofbirth', dateofbirth, \n    'age', age, \n    'idType', idType,\n    'idNumber', idNumber,\n    'cIdOther', idOther,\n    'cIdExpiration', idExpiration,\n    'phoneNumber', phoneNumber, \n    'emailAddress', emailAddress, \n    'emailAddressIsInvalid', emailAddressIsInvalid, \n    'emailAddressIsOptedOut', emailAddressIsOptedOut,\n    'languagesSpoken', languagesSpoken,\n    'preferredLanguage', preferredLanguage\n);"",""isolateVariables"":false},{""type"":""taskScript"",""center"":{""x"":540,""y"":200},""id"":""6qto03f8ir"",""text"":""Link affected household to existing PA"",""description"":null,""formula"":""record\\relate('AffectedHousehold', id , 'cPersonAffected', $PAId);"",""isolateVariables"":false},{""startId"":""hnd1x4wtrd"",""endId"":""7egut5oc75"",""startDirection"":""r"",""id"":""ouqubrtz8p"",""type"":""flow""},{""startId"":""7egut5oc75"",""endId"":""g26501dqtx"",""startDirection"":""r"",""id"":""vwcpoey0zc"",""type"":""flow""},{""startId"":""g26501dqtx"",""endId"":""43vu6dm3ec"",""startDirection"":""u"",""id"":""1zu8oy54j5"",""type"":""flow"",""isDefault"":false},{""startId"":""g26501dqtx"",""endId"":""6qto03f8ir"",""startDirection"":""d"",""id"":""1lel1th6cp"",""type"":""flow"",""isDefault"":false},{""startId"":""6qto03f8ir"",""endId"":""4cio96rbso"",""startDirection"":""r"",""id"":""uxte1neyqn"",""type"":""flow""},{""startId"":""43vu6dm3ec"",""endId"":""6qto03f8ir"",""startDirection"":""r"",""id"":""bwmh59d30g"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""hnd1x4wtrd""]","2024-11-05 12:04:54","2025-09-25 13:11:15",,,,,671fa426716cd8d35,,68d530a06516d55bf,Admin
671fb633abcac50a3,"AffectedHousehold - Calculate eligibility score","When a new affected household is created, or updated, an eligibility score is calculated based on criteria set in this workflow. Based on the score, the eligibility status is determined (rejected, needs validation or approved). This formula should be adapted to the context.",AffectedHousehold,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":60,""y"":140},""triggerType"":""afterRecordSaved"",""isInterrupting"":false,""id"":""u8th720cqx"",""text"":""When new affected household is created or changed"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""taskScript"",""center"":{""x"":240,""y"":140},""id"":""99nmzdcpur"",""text"":""Example eligibility formula"",""description"":null,""formula"":""\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\/\/ Vulnerability score calculation \/\/\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\n\/\/ A eligibility score is calculated for affected households\n\/\/ First, sub-totals are calculated per theme: Housing situation, household composition, difficulties, employment status\n\/\/ Afterwards, those sub-totals are summed for the two different vulnerability scores\n\/\/ Lastly, the status is set for the application\n\n\/\/-----------------------------------\n\/\/ Step 1: Calculate subtotals per theme\n\/\/-----------------------------------\n\n\/\/ Household composition\n$single = ifThenElse(singleHeaded == 'yes', 1, 0); \/\/ If the head of household is single, 1 point will be added to the score\n\n$elderlyheaded = ifThenElse(age >= 60, 1, 0); \/\/ If the age of the head of household is equal or greater than 60, 1 point will be added to the score\n\n$largefamily = ifThenElse(hhTotal > 3, 3, 0); \/\/ If the household size is larger than 3, 3 points will be added to the score\n\n$householdcompositionscore = $single + $elderlyheaded + $largefamily; \/\/ Sum all scores for household composition\n\n\/\/ Physical and chronic difficulties\n$health = ifThenElse(membersSpecificNeeds == 'yes', 1, 0); \/\/ If there is a member with specific needs in the household, 1 point will be added to the score\n\n\/\/ Housing Situation\n$accommodationtype = ifThenElse(accommodationType == 'collectivecentre' || accommodationType == 'donothaveaccommodation' || accommodationType == 'hotel', 1, 0); \/\/ If the current housing situation of the affected household is in a collective centre, does not have accommodation or in a hotel, 1 point is added to the score\n\n\n\/\/-----------------------------------\n\/\/ Step 2: Calculate total eligibility score\n\/\/-----------------------------------\n\n\/\/ Summ all subtotals per theme to get the total eligibility score\neligibilityScore = $householdcompositionscore + $health + $accommodationtype; \n\n\n\/\/-----------------------------------\n\/\/ Step 3: Set status for application\n\/\/-----------------------------------\n\n\/\/ Define eligibility status automatically based on eligibility score\nifThenElse(eligibilityScore <= 2, eligibilityStatus = 'rejected', ifThenElse(eligibilityScore > 4, eligibilityStatus = 'approved', eligibilityStatus = 'needsValidation')); \/\/ If the eligibility score is equal or lower than 2, the application is rejected, if the eligibility score is higher than 4, the application is approved, otherwise the application needs validation\n\n\/\/ It is also possible to immediately reject or accept someone depending on one criteria. For example, if head of household is below 18 years old, the registration is rejected automatically\nifThen(age <= 18, eligibilityStatus = 'rejected');\n\n\n\/\/ Manual change of status to overrule the automatic status\nifThen((manualApproval == true) && (eligibilityStatus == 'needsValidation'), eligibilityStatus = 'approved');\n\nifThen((manualApproval == true) && (eligibilityStatus == 'rejected'), eligibilityStatus = 'approved');\n\nifThen((rejectManually == true) && (eligibilityStatus == 'approved'), eligibilityStatus = 'rejected');\n\nifThen((rejectManually == true) && (eligibilityStatus == 'needsValidation'), eligibilityStatus = 'rejected');""},{""type"":""eventEnd"",""center"":{""x"":400,""y"":140},""id"":""g7khc0p1wa""},{""startId"":""u8th720cqx"",""endId"":""99nmzdcpur"",""startDirection"":""r"",""id"":""60xt53kgrv"",""type"":""flow""},{""startId"":""99nmzdcpur"",""endId"":""g7khc0p1wa"",""startDirection"":""r"",""id"":""1c5patjjb8"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""u8th720cqx""]","2024-10-28 16:05:07","2025-09-25 12:33:40",,,,,671fa426716cd8d35,,671fa426716cd8d35,
671fb6339dd496a27,"Accommodation - Create or Link PA from accommodation","When a new accommodation form is filled in, search in PA entity if there is an existing PA record with the same ID number.

If PA record exisits, link accommodation to PA record. If PA record does not exist, create a new PA and fill in the information from the accommodation record.",Accommodation,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":60,""y"":160},""triggerType"":""afterRecordCreated"",""isInterrupting"":false,""id"":""1bt7k315hn"",""text"":""When accommodation is created"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""taskScript"",""center"":{""x"":200,""y"":160},""id"":""cardo7ba7e"",""text"":""Search for existing PA with equal ID number"",""description"":null,""formula"":""$PAId = record\\findOne('CPersonAffected', 'createdAt', 'desc', 'idNumber', idNumber);""},{""type"":""gatewayExclusive"",""center"":{""x"":340,""y"":160},""id"":""3bam53pp81"",""text"":""Check if PA already exists"",""defaultFlowId"":null,""flowList"":[{""id"":""cj2et7ue30"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":""$PAId == null;""},{""id"":""z1jczi74ky"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":""$PAId != null;""}],""description"":null},{""type"":""task"",""center"":{""x"":460,""y"":100},""id"":""ne13bv5umr"",""text"":""Create related PA with all information"",""actionList"":[{""formula"":""$PAId = record\\create(\n    'CPersonAffected',\n    'firstName', firstName, \n    'lastName', lastName, \n    'nationality', nationality,\n    'gender', gender, \n    'dateofbirth', dateofbirth, \n    'age', age, \n    'idType', idType,\n    'idNumber', idNumber,\n    'cIdOther', idOther,\n    'cIdExpiration', idExpiration,\n    'phoneNumber', phoneNumber, \n    'emailAddress', emailAddress, \n    'emailAddressIsInvalid', emailAddressIsInvalid, \n    'emailAddressIsOptedOut', emailAddressIsOptedOut,\n    'languagesSpoken', languagesSpoken,\n    'preferredLanguage', preferredLanguage\n);"",""cid"":0,""id"":""3ukail0qcv"",""type"":""executeFormula""}],""description"":null,""isolateVariables"":false},{""type"":""taskScript"",""center"":{""x"":620,""y"":160},""id"":""y1qyvbthev"",""text"":""Link accommodation to existing PA"",""description"":null,""formula"":""record\\relate('Accommodation', id , 'cPersonAffected', $PAId);"",""isolateVariables"":false},{""startId"":""1bt7k315hn"",""endId"":""cardo7ba7e"",""startDirection"":""r"",""id"":""izqof8gm6s"",""type"":""flow""},{""startId"":""cardo7ba7e"",""endId"":""3bam53pp81"",""startDirection"":""r"",""id"":""jbf3uscf0q"",""type"":""flow""},{""startId"":""3bam53pp81"",""endId"":""ne13bv5umr"",""startDirection"":""u"",""id"":""cj2et7ue30"",""type"":""flow"",""isDefault"":false},{""startId"":""3bam53pp81"",""endId"":""y1qyvbthev"",""startDirection"":""d"",""id"":""z1jczi74ky"",""type"":""flow"",""isDefault"":false},{""type"":""eventEnd"",""center"":{""x"":740,""y"":160},""id"":""rtj7hay32u""},{""startId"":""y1qyvbthev"",""endId"":""rtj7hay32u"",""startDirection"":""r"",""id"":""84f7oki7md"",""type"":""flow""},{""startId"":""ne13bv5umr"",""endId"":""y1qyvbthev"",""startDirection"":""r"",""id"":""itqmbesadv"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""1bt7k315hn""]","2024-10-28 16:05:07","2025-09-25 13:14:22",,,,,671fa426716cd8d35,,68d530a06516d55bf,Admin
671fb6338f1a7d5b9,"AffectedHousehold - Translate text box into English","Translates comment box to English
NOTE: URL needs to be added that takes care of the translation of the comment box.",AffectedHousehold,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":100},""triggerType"":""afterRecordCreated"",""isInterrupting"":false,""id"":""5fbentyp6j"",""text"":""After record created with comment box"",""conditionsAll"":[{""comparison"":""notEmpty"",""cid"":0,""fieldToCompare"":""commentBox"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":260},""triggerType"":""afterRecordUpdated"",""isInterrupting"":false,""id"":""1zoapqbp1t"",""text"":""After comment box changed"",""conditionsAll"":[{""comparison"":""changed"",""cid"":0,""fieldToCompare"":""commentBox"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""task"",""center"":{""x"":280,""y"":180},""id"":""0chwe786hk"",""text"":""Translate comment box to English"",""actionList"":[{""requestType"":""POST"",""contentType"":""application\/json"",""content"":""{\n    \""text\"":\""{$commentBox}\""\n}"",""requestUrl"":""ADD_URL"",""headers"":[],""contentVariable"":null,""cid"":0,""id"":""bkvciotkt0"",""type"":""sendRequest""},{""formula"":""commentBoxEnglish = $_lastHttpResponseBody;"",""cid"":1,""id"":""mb2unjtc86"",""type"":""executeFormula""}],""description"":null,""isolateVariables"":false},{""type"":""eventEnd"",""center"":{""x"":440,""y"":180},""id"":""2216jmnbe5""},{""startId"":""5fbentyp6j"",""endId"":""0chwe786hk"",""startDirection"":""r"",""id"":""eh5yummrc9"",""type"":""flow""},{""startId"":""1zoapqbp1t"",""endId"":""0chwe786hk"",""startDirection"":""r"",""id"":""id0hm51o67"",""type"":""flow""},{""startId"":""0chwe786hk"",""endId"":""2216jmnbe5"",""startDirection"":""r"",""id"":""c2mjl2q5la"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""5fbentyp6j"",""1zoapqbp1t""]","2024-10-28 16:05:07","2025-09-25 13:36:02",,,,,671fa426716cd8d35,,68d530a06516d55bf,Admin
671fb6337f50a58f8,"Accommodation - Translate text box into English","Translates comment box to English
NOTE: URL needs to be added that takes care of the translation of the comment box.",Accommodation,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":120},""triggerType"":""afterRecordCreated"",""isInterrupting"":false,""id"":""r3e5yt5wvv"",""text"":""After record created with comment box"",""description"":null,""conditionsAll"":[{""comparison"":""notEmpty"",""cid"":0,""fieldToCompare"":""commentBox"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null},{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":280},""triggerType"":""afterRecordUpdated"",""isInterrupting"":false,""id"":""z0przd04ik"",""text"":""After comment box changed"",""conditionsAll"":[{""comparison"":""changed"",""cid"":0,""fieldToCompare"":""commentBox"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""task"",""center"":{""x"":280,""y"":200},""id"":""az5yaotd4a"",""text"":""Translate comment box to English"",""description"":null,""actionList"":[{""requestType"":""POST"",""contentType"":""application\/json"",""content"":""{\n    \""text\"":\""{$commentBox}\""\n}"",""requestUrl"":""ADD_URL"",""headers"":[],""contentVariable"":null,""cid"":0,""id"":""7i9x2ldwd1"",""type"":""sendRequest""},{""formula"":""commentBoxEnglish= $_lastHttpResponseBody;"",""cid"":1,""id"":""6wzx9gz5tf"",""type"":""executeFormula""}],""isolateVariables"":false},{""type"":""eventEnd"",""center"":{""x"":420,""y"":200},""id"":""dbn1btl7uk""},{""startId"":""r3e5yt5wvv"",""endId"":""az5yaotd4a"",""startDirection"":""r"",""id"":""oghkeaxl46"",""type"":""flow""},{""startId"":""az5yaotd4a"",""endId"":""dbn1btl7uk"",""startDirection"":""r"",""id"":""j9bs5lojol"",""type"":""flow""},{""startId"":""z0przd04ik"",""endId"":""az5yaotd4a"",""startDirection"":""r"",""id"":""h4miks4ixb"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""r3e5yt5wvv"",""z0przd04ik""]","2024-10-28 16:05:07","2025-09-25 13:36:18",,,,,671fa426716cd8d35,,68d530a06516d55bf,Admin
671fb63370a366ffb,"Match - Verify IBAN number",,Combined,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":80,""y"":100},""triggerType"":""afterRecordCreated"",""isInterrupting"":false,""id"":""rn18irun4z"",""text"":""When created, with IBAN"",""conditionsAll"":[{""comparison"":""notEmpty"",""subjectType"":""value"",""cid"":0,""fieldToCompare"":""iban"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""eventStartConditional"",""center"":{""x"":80,""y"":220},""triggerType"":""afterRecordUpdated"",""isInterrupting"":false,""id"":""uabb8245no"",""text"":""When IBAN changed"",""conditionsAll"":[{""comparison"":""changed"",""subjectType"":""value"",""cid"":0,""fieldToCompare"":""iban"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""task"",""center"":{""x"":260,""y"":160},""id"":""kqbjsmksk4"",""text"":""Verify IBAN"",""actionList"":[{""requestType"":""GET"",""contentType"":""application\/json"",""content"":""{}"",""requestUrl"":""https:\/\/openiban.com\/validate\/{$iban}"",""headers"":[],""contentVariable"":null,""cid"":0,""id"":""ybs02rf6b8"",""type"":""sendRequest""},{""formula"":""validIBAN = json\\retrieve($_lastHttpResponseBody, 'valid');\nifThenElse(validIBAN == false, ibanVerify = 'WARNING! THE IBAN THAT YOU HAVE SUBMITTED IS NOT VALID. PLEASE REVIEW AND UPLOAD THE CORRECT NUMBER.', ibanVerify = 'The IBAN you have submitted is valid.');\n\/\/validIBAN = $verifyIBAN"",""cid"":1,""id"":""ejkd290kox"",""type"":""executeFormula""}],""description"":null},{""type"":""eventEnd"",""center"":{""x"":400,""y"":160},""id"":""hadyoenqkm""},{""startId"":""rn18irun4z"",""endId"":""kqbjsmksk4"",""startDirection"":""r"",""id"":""hwk9zz5g1j"",""type"":""flow""},{""startId"":""uabb8245no"",""endId"":""kqbjsmksk4"",""startDirection"":""r"",""id"":""1z8osnbx63"",""type"":""flow""},{""startId"":""kqbjsmksk4"",""endId"":""hadyoenqkm"",""startDirection"":""r"",""id"":""2qkdhxn2jd"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""rn18irun4z"",""uabb8245no""]","2024-10-28 16:05:07","2025-09-25 12:33:40",,,,,671fa426716cd8d35,,671fa426716cd8d35,
671fb63365c10a150,"AccommodationAdequacy - Link with accommodation","When an accommodation adequacy form is saved (created or updated), the corresponding accommodation (with same ID) is linked and the verification status is set to pending",AdequacyCriteria,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":140},""triggerType"":""afterRecordSaved"",""isInterrupting"":false,""id"":""ghmsr35bty"",""text"":""After record saved"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""taskScript"",""center"":{""x"":260,""y"":140},""id"":""yd73n33bm6"",""text"":""Find existing accommodation and link it"",""description"":null,""formula"":""$accLink = record\\findOne('Accommodation', 'createdAt', 'desc', 'acID', accommodationID);\n\naccommodationId = $accLink;""},{""type"":""eventEnd"",""center"":{""x"":540,""y"":140},""id"":""sd8zbujnud""},{""startId"":""ghmsr35bty"",""endId"":""yd73n33bm6"",""startDirection"":""r"",""id"":""8aftqb78s2"",""type"":""flow""},{""type"":""taskScript"",""center"":{""x"":420,""y"":140},""id"":""oxk9evgf59"",""text"":""Update verification status to pending"",""description"":null,""formula"":""record\\update('Accommodation', accommodationId, 'verificationStatus', 'pending');""},{""startId"":""yd73n33bm6"",""endId"":""oxk9evgf59"",""startDirection"":""r"",""id"":""8lgvjjl9d2"",""type"":""flow""},{""startId"":""oxk9evgf59"",""endId"":""sd8zbujnud"",""startDirection"":""r"",""id"":""fz0dt2n7kb"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""ghmsr35bty""]","2024-10-28 16:05:07","2025-09-25 12:33:40",,,,,671fa426716cd8d35,,671fa426716cd8d35,
671fb6335a2cb4906,"Match - Create transfer(s) based on Cash Distribution","When a Cash Distribution is assigned to a Match, create the transfer(s) for the match.",Combined,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":80,""y"":140},""triggerType"":""afterRecordUpdated"",""isInterrupting"":false,""id"":""8rigp7uxg5"",""text"":""Cash Distribtution is assigned to a Match"",""conditionsAll"":[{""comparison"":""notEmpty"",""cid"":0,""fieldToCompare"":""cashDistribution"",""type"":""all""},{""comparison"":""changed"",""cid"":1,""fieldToCompare"":""cashDistribution"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null,""description"":null},{""type"":""taskScript"",""center"":{""x"":240,""y"":140},""id"":""5woz05bgv8"",""text"":""Create transfer(s)"",""description"":null,""formula"":""\/\/ Initialize counter for looping\n$i = 0;\n\n\/\/ For the number of transfers to be created\nwhile(\n    $i < cashDistribution.numberOfTransfers,\n    (\n        \/\/ Set transfer date for this payment based on frequency\n        ifThen(cashDistribution.frequency == 'oneOff', \n            $transferDate = cashDistribution.transferDate;\n        );\n        \n        ifThen(cashDistribution.frequency == 'daily', \n            $transferDate = datetime\\addDays(cashDistribution.transferDate, $i);\n        );\n        \n        ifThen(cashDistribution.frequency == 'weekly', \n            $transferDate = datetime\\addWeeks(cashDistribution.transferDate, $i);\n        );\n        \n        ifThen(cashDistribution.frequency == 'biweekly', \n            $transferDate = datetime\\addWeeks(cashDistribution.transferDate, 2 * $i);\n        );\n                \n        ifThen(cashDistribution.frequency == 'monthly', \n            $transferDate = datetime\\addMonths(cashDistribution.transferDate, $i);\n        );\n        \n        \/\/ Create tranfser record, with information from Cash Distribution\n        $transferId = record\\create('Transfer', 'transferDate', $transferDate, 'transferValue', cashDistribution.transferValue, 'transferType', cashDistribution.transferType, 'deliveryMechanism', cashDistribution.deliveryMechanism, 'status', 'planned');\n        \n        \/\/ Add name to transfer record\n        $name = string\\concatenate('Transfer - ', name, ' - ', cashDistribution.name, ' - ', $i + 1);\n        record\\update('Transfer', $transferId, 'name', $name);\n        \n        \/\/ Relate created transfer record to current Match and to Cash Distribution\n        record\\relate('Transfer', $transferId, 'combined', id);\n        record\\relate('Transfer', $transferId, 'cashDistribution', cashDistributionId);\n        \n        \/\/ Update counter for looping\n        $i = $i + 1;\n    )\n);""},{""type"":""taskScript"",""center"":{""x"":400,""y"":140},""id"":""pnyytk1cq8"",""text"":""Remove Cash Distribution from Match"",""description"":null,""formula"":""cashDistributionId = null;""},{""startId"":""8rigp7uxg5"",""endId"":""5woz05bgv8"",""startDirection"":""r"",""id"":""t2h1odhcof"",""type"":""flow""},{""startId"":""5woz05bgv8"",""endId"":""pnyytk1cq8"",""startDirection"":""r"",""id"":""28x5y2mca2"",""type"":""flow""},{""type"":""eventEnd"",""center"":{""x"":540,""y"":140},""id"":""j5xjp1b4l4""},{""startId"":""pnyytk1cq8"",""endId"":""j5xjp1b4l4"",""startDirection"":""r"",""id"":""456rlc7i78"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""8rigp7uxg5""]","2024-10-28 16:05:07","2025-09-25 12:33:40",,,,,671fa426716cd8d35,,671fa426716cd8d35,
671fb633447e59522,"AffectedHouseholds - Duplicate check based on ID and name","Whenever an affected household is created, or updated (name or ID) and for every 5 mins for all affected households, the following happens:

Find duplicates on ID, if there are any, mark them as duplicate.
If there's no duplicate on ID, find duplicates on name.
If there's duplicates on name, mark them as potential duplicates.
If there's no duplicates on name (and thus also not on ID), mark them as unique.

This flow can be adjusted to the context.",AffectedHousehold,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":40},""triggerType"":""afterRecordCreated"",""isInterrupting"":false,""id"":""b4i92i04hi"",""text"":""After creation"",""description"":null,""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":null},{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":320},""triggerType"":""afterRecordUpdated"",""isInterrupting"":false,""id"":""efxhub31r8"",""text"":""After ID or Name changed"",""conditionsAll"":[],""conditionsAny"":[{""comparison"":""changed"",""subjectType"":""value"",""cid"":0,""fieldToCompare"":""idNumber"",""type"":""any""},{""comparison"":""changed"",""subjectType"":""value"",""cid"":1,""fieldToCompare"":""registrationName"",""type"":""any""}],""conditionsFormula"":null,""description"":null},{""type"":""taskScript"",""center"":{""x"":220,""y"":180},""id"":""6i31wblg3f"",""text"":""Find duplicates on ID Number"",""description"":null,""formula"":""$identificationDuplicateIds = record\\findMany(\""AffectedHousehold\"", 100, \""createdAt\"", \""desc\"", \""idNumber=\"", idNumber);\n$identificationDuplicates = array\\length($identificationDuplicateIds);""},{""type"":""taskScript"",""center"":{""x"":520,""y"":80},""id"":""2z5ghep54b"",""text"":""Check for duplications on name"",""description"":null,""formula"":""$nameDuplicateIds = record\\findMany(\""AffectedHousehold\"", 100, \""createdAt\"", \""desc\"", \""registrationName=\"", registrationName);\n$nameDuplicates = array\\length($nameDuplicateIds);\n""},{""type"":""taskScript"",""center"":{""x"":520,""y"":240},""id"":""ia603hroe3"",""text"":""Mark as duplicate"",""description"":null,""formula"":""\/\/ Mark all duplicates as duplicated\n$i = 0;\nwhile ($i < $identificationDuplicates ) {\n    $regId = array\\at($identificationDuplicateIds, $i);\n    record\\update(\""AffectedHousehold\"", $regId, \""duplicateCheck\"", \""duplicate\"");\n    $i = $i + 1;\n};""},{""type"":""gatewayExclusive"",""center"":{""x"":360,""y"":180},""id"":""rprqdhr0r0"",""text"":null,""description"":null,""defaultFlowId"":null,""flowList"":[{""id"":""vbispfnp9b"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":""$identificationDuplicates == 1""},{""id"":""rywhwcbwhq"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":""$identificationDuplicates > 1""}]},{""startId"":""rprqdhr0r0"",""endId"":""2z5ghep54b"",""startDirection"":""u"",""id"":""vbispfnp9b"",""type"":""flow"",""isDefault"":false},{""startId"":""rprqdhr0r0"",""endId"":""ia603hroe3"",""startDirection"":""d"",""id"":""rywhwcbwhq"",""type"":""flow"",""isDefault"":false},{""startId"":""6i31wblg3f"",""endId"":""rprqdhr0r0"",""startDirection"":""r"",""id"":""f7nujphrrk"",""type"":""flow""},{""startId"":""b4i92i04hi"",""endId"":""6i31wblg3f"",""startDirection"":""r"",""id"":""0tp9rnhp9i"",""type"":""flow""},{""startId"":""efxhub31r8"",""endId"":""6i31wblg3f"",""startDirection"":""r"",""id"":""raunnp58n4"",""type"":""flow""},{""type"":""taskScript"",""center"":{""x"":740,""y"":20},""id"":""2z66v2jkso"",""text"":""Mark as Unique"",""description"":null,""formula"":""duplicateCheck = \""unique\"";""},{""type"":""taskScript"",""center"":{""x"":740,""y"":140},""id"":""ynnk8qztot"",""text"":""Mark as potential duplicate"",""description"":null,""formula"":""\/\/ Mark all duplicates that are now unique as potential duplicate\n$i = 0;\nwhile ($i < $nameDuplicates ) {\n    $regId = array\\at($nameDuplicateIds, $i);\n    $duplicationStatus = record\\attribute(\""AffectedHousehold\"", $regId, \""duplicateCheck\"");\n    \/\/ Do not mark when reg is already id duplicate or potential duplicate\n    if ($duplicationStatus == \""unique\""){\n        record\\update(\""AffectedHousehold\"", $regId, \""duplicateCheck\"", \""potentialDuplicate\"");\n    };\n    $i = $i + 1;\n};""},{""type"":""gatewayExclusive"",""center"":{""x"":640,""y"":80},""id"":""ouv67we84n"",""text"":null,""defaultFlowId"":null,""flowList"":[{""id"":""p6xtce6e6p"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":""$nameDuplicates == 1""},{""id"":""7z7wnb7qgs"",""conditionsAll"":[],""conditionsAny"":[],""conditionsFormula"":""$nameDuplicates > 1""}],""description"":null},{""startId"":""2z5ghep54b"",""endId"":""ouv67we84n"",""startDirection"":""r"",""id"":""pvm1wd35qg"",""type"":""flow""},{""startId"":""ouv67we84n"",""endId"":""2z66v2jkso"",""startDirection"":""u"",""id"":""p6xtce6e6p"",""type"":""flow"",""isDefault"":false},{""startId"":""ouv67we84n"",""endId"":""ynnk8qztot"",""startDirection"":""d"",""id"":""7z7wnb7qgs"",""type"":""flow"",""isDefault"":false},{""type"":""eventStartTimer"",""center"":{""x"":100,""y"":180},""isInterrupting"":false,""timerBase"":null,""timerShift"":0,""timerShiftUnits"":""minutes"",""timerShiftOperator"":""plus"",""timerFormula"":null,""targetReportId"":""657085f65fc4e4897"",""scheduling"":""*\/5 * * * *"",""schedulingApplyTimezone"":false,""id"":""qhu6hf5s45"",""text"":""Run every 5 min on every Affected Household"",""description"":null,""targetReportName"":""All affected households""},{""startId"":""qhu6hf5s45"",""endId"":""6i31wblg3f"",""startDirection"":""r"",""id"":""xl7pfssfpf"",""type"":""flow""},{""type"":""task"",""center"":{""x"":940,""y"":140},""id"":""5rs81xrykd"",""text"":""Delete Process"",""description"":""Important step, so that the system will not be overloaded with processes"",""actionList"":[{""fieldList"":[],""fields"":{},""cid"":0,""id"":""owux6ogv8c"",""formula"":""deleted = 1;"",""type"":""updateProcessEntity""}]},{""startId"":""2z66v2jkso"",""endId"":""5rs81xrykd"",""startDirection"":""r"",""id"":""eci6pqnups"",""type"":""flow""},{""startId"":""ynnk8qztot"",""endId"":""5rs81xrykd"",""startDirection"":""r"",""id"":""dle78ye6c7"",""type"":""flow""},{""startId"":""ia603hroe3"",""endId"":""5rs81xrykd"",""startDirection"":""r"",""id"":""v4n88bi5be"",""type"":""flow""},{""type"":""eventEnd"",""center"":{""x"":1080,""y"":140},""id"":""bpiilv1l6z""},{""startId"":""5rs81xrykd"",""endId"":""bpiilv1l6z"",""startDirection"":""r"",""id"":""isxxfs2iip"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""b4i92i04hi"",""efxhub31r8"",""qhu6hf5s45""]","2024-10-28 16:05:07","2025-09-25 12:33:40",,,,,671fa426716cd8d35,,671fa426716cd8d35,
671fb6332fdafe398,"Message - Send message","Send out the queued messages via Twilio.
IMPORTANT:
- Authentication Key (authenticationKeyTwilio) need to be set in the App Secrets in order to actually send the messages.
- Account ID needs to be updated in this flow.",Message,"{""list"":[{""type"":""eventStartTimer"",""center"":{""x"":100,""y"":160},""isInterrupting"":false,""timerBase"":null,""timerShift"":0,""timerShiftUnits"":""minutes"",""timerShiftOperator"":""plus"",""timerFormula"":null,""targetReportId"":""659ff99ee82fbbe96"",""scheduling"":""*\/1 * * * *"",""schedulingApplyTimezone"":false,""id"":""tokg2ez4w6"",""text"":""Every minute to 'queued' messages"",""description"":null,""targetReportName"":""Messages to be send""},{""type"":""task"",""center"":{""x"":260,""y"":160},""id"":""ebshkmzlvl"",""text"":""Send message"",""actionList"":[{""fieldList"":[""status""],""fields"":{""status"":{""subjectType"":""value"",""attributes"":{""status"":""failed""}}},""cid"":0,""id"":""f7rs1rhcrg"",""formula"":null,""type"":""updateEntity""},{""formula"":""\/\/ If phone number starts with \""00, replace this with \""+\""\nifThen(\n    string\\substring(to, 0, 2) == \""00\"", \n    to = string\\concatenate(\""+\"", string\\substring(to, 2))\n);"",""cid"":1,""id"":""ty9880fxyr"",""type"":""executeFormula""},{""formula"":""\/\/ Set your account ID\n$accountID = 'YOUR_ACCOUNT_ID';"",""cid"":2,""id"":""w0nqnmqo76"",""type"":""executeFormula""},{""requestType"":""POST"",""contentType"":""application\/x-www-form-urlencoded"",""content"":""{\n\t\""To\"": \""{$to}\"",\n\t\""From\"": \""{$from}\"",\n\t\""Body\"": \""{$sendBody}\""\n}"",""requestUrl"":""https:\/\/api.twilio.com\/2010-04-01\/Accounts\/{$$accountID}\/Messages.json"",""headers"":[""Authorization: {#secrets.authenticationKeyTwilio}""],""contentVariable"":null,""cid"":3,""id"":""t9ev1t3yq9"",""type"":""sendRequest""},{""formula"":""\/\/ Set the sent time to now\nsent = datetime\\now();\n\n\/\/ Retrieve the sid, status and error code from the response\n$sid = json\\retrieve($_lastHttpResponseBody, 'sid');\n$status = json\\retrieve($_lastHttpResponseBody, 'status');\n$error = json\\retrieve($_lastHttpResponseBody, 'error_code');\n\n\/\/ Set the sid, status and error code in the message\nsid = $sid;\nstatus = $status;\nerrorcode = $error;"",""cid"":4,""id"":""tk0hta51p6"",""type"":""executeFormula""}],""description"":null,""isolateVariables"":false},{""type"":""eventEnd"",""center"":{""x"":400,""y"":160},""id"":""w93ieg6q1y""},{""startId"":""tokg2ez4w6"",""endId"":""ebshkmzlvl"",""startDirection"":""r"",""id"":""jr4lqmb2bb"",""type"":""flow""},{""startId"":""ebshkmzlvl"",""endId"":""w93ieg6q1y"",""startDirection"":""r"",""id"":""ybnf2uvw7l"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""tokg2ez4w6""]","2024-10-28 16:05:07","2025-09-25 12:33:40",,,,,671fa426716cd8d35,,6888e2fea275a3ad6,
671fb6332660d45c1,"Accommodation - Create message based on Message template","When a message template is added to the field ""Send message"" in the Accommodation entity, a Message record will be created with the body of the message template (in the preferred language), the phone number of the property owner and the status ""to be send"", so that it will be put in the queue to send the message out (in a different flow)",Accommodation,"{""list"":[{""type"":""eventStartConditional"",""center"":{""x"":100,""y"":140},""triggerType"":""afterRecordUpdated"",""isInterrupting"":false,""id"":""9wr7in2hr4"",""text"":""Message template is assigned to accommodation"",""description"":null,""conditionsAll"":[{""comparison"":""notEmpty"",""cid"":0,""fieldToCompare"":""messageTemplate"",""type"":""all""},{""comparison"":""changed"",""cid"":1,""fieldToCompare"":""messageTemplate"",""type"":""all""}],""conditionsAny"":[],""conditionsFormula"":null},{""type"":""taskScript"",""center"":{""x"":240,""y"":140},""id"":""81s5qj75l7"",""text"":""Create message"",""description"":null,""formula"":""\/\/---- get language of message based on preferred language -----\n\n\/\/ get preferred language\n$lan = preferredLanguage;\n\n\/\/ set default language\nifThen($lan == None, $lan = 'en');\nifThen($lan == 'other', $lan = 'en');\n\n\/\/ set body of message based on lagnauge\n\/\/ --- UPDATE THIS PART BASED ON POSSIBLE LANGUAGES IN SYSTEM ---\nifThenElse($lan == 'en', $body = messageTemplate.bodyEN);\nifThenElse($lan == 'fr', $body = messageTemplate.bodyFR);\nifThenElse($lan == 'ar', $body = messageTemplate.bodyAR);\nifThenElse($lan == 'zh', $body = messageTemplate.bodyZH);\nifThenElse($lan == 'ru', $body = messageTemplate.bodyRU);\nifThenElse($lan == 'es', $body = messageTemplate.bodyES);\n\n\/\/ create message record, with information from message template\n$messageId = record\\create('Message', 'sendBody', $body, 'to', phoneNumber, 'status', 'tobe', 'language', $lan);\n\n \/\/ add name to message record\n$name = string\\concatenate(messageTemplate.name, ' - ', acID, ' - ', datetime\\today());\nrecord\\update('Message', $messageId, 'name', $name);\n\n\/\/ Relate created message record to accommodation, PA and to message template\nrecord\\relate('Message', $messageId, 'accommodation', id);\nrecord\\relate('Message', $messageId, 'cPersonAffected', cPersonAffectedId);\nrecord\\relate('Message', $messageId, 'messageTemplate', messageTemplateId); "",""isolateVariables"":false},{""type"":""taskScript"",""center"":{""x"":380,""y"":140},""id"":""u4rwn9r79j"",""text"":""Remove Message Template from Accommodation"",""description"":null,""formula"":""messageTemplateId = null;""},{""type"":""eventEnd"",""center"":{""x"":500,""y"":140},""id"":""b697ff3xzo""},{""startId"":""9wr7in2hr4"",""endId"":""81s5qj75l7"",""startDirection"":""r"",""id"":""kkjqqd0jtn"",""type"":""flow""},{""startId"":""81s5qj75l7"",""endId"":""u4rwn9r79j"",""startDirection"":""r"",""id"":""6b5dm0csih"",""type"":""flow""},{""startId"":""u4rwn9r79j"",""endId"":""b697ff3xzo"",""startDirection"":""r"",""id"":""b0y5ivnkfj"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""9wr7in2hr4""]","2024-10-28 16:05:07","2025-09-25 13:25:37",,,,,671fa426716cd8d35,,68d530a06516d55bf,Admin
671fb63319eb89222,"Message - Update message status","Get the messages status.
IMPORTANT:
- Authentication Key (authenticationKeyTwilio) need to be set in the App Secrets in order to actually send the messages.
- Account ID needs to be updated in this flow.",Message,"{""list"":[{""type"":""eventStartTimer"",""center"":{""x"":100,""y"":120},""isInterrupting"":false,""timerBase"":null,""timerShift"":0,""timerShiftUnits"":""minutes"",""timerShiftOperator"":""plus"",""timerFormula"":null,""targetReportId"":""65a5124447a91b70b"",""scheduling"":""*\/5 * * * *"",""schedulingApplyTimezone"":false,""id"":""0v4rwqp0vx"",""text"":""Every 5 minutes, on to be updated messages"",""description"":null,""targetReportName"":""Messages to have updated status""},{""type"":""task"",""center"":{""x"":260,""y"":120},""id"":""t0ghwbge0f"",""text"":""Update message status"",""description"":null,""actionList"":[{""formula"":""\/\/ Set your account ID\n$accountID = 'YOUR_ACCOUNT_ID';"",""cid"":0,""id"":""i9iav2nazy"",""type"":""executeFormula""},{""requestType"":""GET"",""contentType"":null,""content"":""{}"",""requestUrl"":""https:\/\/api.twilio.com\/2010-04-01\/Accounts\/{$$accountID}\/Messages\/{$sid}.json"",""headers"":[""Authorization: {#secrets.authenticationKeyTwilio}""],""contentVariable"":null,""cid"":1,""id"":""q6gl4c265i"",""type"":""sendRequest""},{""formula"":""\/\/ Retrieve status and error code from response\n$status = json\\retrieve($_lastHttpResponseBody, 'status');\n$errorcode = json\\retrieve($_lastHttpResponseBody, 'error_code');\n\n\/\/ Set status and error code in message\nstatus = $status;\nerrorcode = $errorcode;"",""cid"":2,""id"":""5if7qh37hk"",""type"":""executeFormula""}],""isolateVariables"":false},{""type"":""eventEnd"",""center"":{""x"":400,""y"":120},""id"":""uhsnvh54gv""},{""startId"":""0v4rwqp0vx"",""endId"":""t0ghwbge0f"",""startDirection"":""r"",""id"":""wyndf91ecj"",""type"":""flow""},{""startId"":""t0ghwbge0f"",""endId"":""uhsnvh54gv"",""startDirection"":""r"",""id"":""pmrbvax1z7"",""type"":""flow""}],""createdEntitiesData"":{}}",1,[],"[""0v4rwqp0vx""]","2024-10-28 16:05:07","2025-09-25 12:33:40",,,,,671fa426716cd8d35,,6888e2fea275a3ad6,
